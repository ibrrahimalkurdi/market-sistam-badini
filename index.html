<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>پانێلا کرێکاران</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="پانێلا کرێکاران">
    <meta name="theme-color" content="#0077b6">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <style>
        :root {--primary-color: #0077b6;--secondary-color: #00b4d8;--success-color: #2a9d8f;--danger-color: #e63946;--background-color: #f0f3f5;--card-bg: #ffffff;--text-color: #2b2d42;--border-radius: 12px;--box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);--light-gray: #e9ecef;}
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600;700&display=swap');
        body {font-family: 'Vazirmatn', sans-serif;margin: 0;background-color: var(--background-color);color: var(--text-color);font-size: 16px;line-height: 1.6;}
        header {background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));color: white;padding: 1rem 1.5rem;display: flex;justify-content: space-between;align-items: center;box-shadow: 0 4px 10px rgba(0,0,0,0.1);}
        header h1 {margin: 0;font-size: 1.5rem;font-weight: 700;}
        #user-info {font-size: 0.9rem;font-weight: 600;}
        main {padding: 1.5rem;max-width: 1200px;margin: auto;}
        .view {display: none;}
        .view.active {display: block;animation: fadeIn 0.4s ease-out;}
        @keyframes fadeIn {from {opacity: 0;transform: translateY(10px);}to {opacity: 1;transform: translateY(0);}}
        .btn {background-color: var(--primary-color);color: white;border: none;padding: 0.8rem 1.8rem;font-size: 1rem;font-weight: 600;border-radius: 8px;cursor: pointer;transition: all 0.25s;display: inline-flex;align-items: center;justify-content: center;gap: 0.5rem;}
        .btn:hover {opacity: 0.85;transform: translateY(-2px);box-shadow: 0 3px 10px rgba(0,0,0,0.1);}
        .btn.success-btn {background-color: var(--success-color);}
        .btn.danger-btn {background-color: var(--danger-color);}
        .back-btn {margin-bottom: 1.5rem;}
        .card {background-color: var(--card-bg);padding: 1.5rem;border-radius: var(--border-radius);box-shadow: var(--box-shadow);margin-bottom: 1.5rem;}
        h2 {margin-top: 0;font-size: 1.4rem;font-weight: 700;color: var(--primary-color);border-bottom: 2px solid var(--light-gray);padding-bottom: 0.5rem;margin-bottom: 1.5rem;}
        .form-group {margin-bottom: 1.2rem;}
        .form-group label {display: block;margin-bottom: 0.5rem;font-weight: 600;}
        .form-group input {width: 100%;padding: 0.8rem;border: 1px solid #ccc;border-radius: 8px;box-sizing: border-box;font-size: 1rem;}
        .form-group input:focus {border-color: var(--primary-color);outline: none;box-shadow: 0 0 0 3px rgba(0, 119, 182, 0.2);}
        #login-view {max-width: 400px;margin: 5rem auto;text-align: center;}
        .dashboard-actions {display: grid;grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));gap: 1.5rem;margin-bottom: 2rem;}
        .action-button {background: var(--card-bg);border: none;padding: 2rem 1rem;border-radius: var(--border-radius);box-shadow: var(--box-shadow);cursor: pointer;transition: all 0.3s;text-align: center;font-family: inherit;}
        .action-button:hover {transform: translateY(-7px);box-shadow: 0 8px 25px rgba(0,0,0,0.12);}
        .action-button .icon {font-size: 3.5rem;color: var(--primary-color);line-height: 1;}
        .action-button h3 {margin: 1rem 0 0;font-size: 1.2rem;color: var(--text-color);}
        #cart-container h3 {font-size: 1.2rem;margin-bottom: 1rem;}
        #cart-items-list {list-style-type: none;padding: 0;margin-bottom: 1.5rem;}
        #cart-items-list li {display: flex;justify-content: space-between;align-items: center;padding: 0.8rem;border-bottom: 1px solid var(--light-gray);font-size: 1rem;}
        #cart-items-list li:last-child {border: none;}
        #cart-items-list .item-name {font-weight: 600;}
        #cart-items-list .item-price {color: var(--success-color);font-weight: 600;}
        #total-price-display {text-align: center;font-size: 1.8rem;font-weight: 700;color: var(--primary-color);background: #f0f8ff;padding: 1rem;border-radius: 8px;margin-bottom: 1.5rem;}
        #total-price-display small {font-size: 1rem;font-weight: 400;}
        .modal {position: fixed;top: 0;left: 0;width: 100%;height: 100%;background: rgba(0,0,0,0.6);display: none;align-items: center;justify-content: center;z-index: 2000;animation: fadeIn 0.3s;}
        .modal.active {display: flex;}
        .modal-content {background: white;padding: 1.5rem 2rem;border-radius: var(--border-radius);width: 90%;max-width: 500px;box-shadow: 0 10px 30px rgba(0,0,0,0.2);}
        .modal-content h3 {margin-top: 0;margin-bottom: 1rem;color: var(--primary-color);}
        #scanner-reader {width: 100%;border-radius: 8px;overflow: hidden;border: 2px solid var(--light-gray);}
        #toast {position: fixed;bottom: -100px;left: 50%;transform: translateX(-50%);background-color: var(--success-color);color: white;padding: 1rem 1.8rem;border-radius: 8px;box-shadow: 0 5px 15px rgba(0,0,0,0.2);transition: bottom 0.5s ease, transform 0.5s ease;z-index: 1000;width: 90%;max-width: 450px;text-align: center;font-size: 1rem;}
        #toast.danger {background-color: var(--danger-color);}
        #toast.show {bottom: 20px;}
        #loader-overlay {position: fixed;top: 0;left: 0;width: 100%;height: 100%;background: rgba(255, 255, 255, 0.9);z-index: 9999;display: flex;justify-content: center;align-items: center;flex-direction: column;}
        .spinner {border: 8px solid #f3f3f3;border-top: 8px solid var(--primary-color);border-radius: 50%;width: 60px;height: 60px;animation: spin 1s linear infinite;}
        @keyframes spin {0% {transform: rotate(0deg);}100% {transform: rotate(360deg);}}
        table {width: 100%;border-collapse: collapse;margin-top: 1rem;}
        th, td {padding: 0.8rem;border-bottom: 1px solid var(--light-gray);text-align: right;white-space: nowrap;}
        th {background-color: #f8f9fa;font-weight: 700;color: var(--primary-color);}
        .amount-col, .price-col {font-weight: 700;color: var(--success-color);}
        .list-wrapper {overflow-x: auto;}
    </style>
</head>
<body>
    <div id="loader-overlay"><div class="spinner"></div></div>

    <header id="main-header" style="display: none;">
        <h1>پانێلا کرێکاران</h1>
        <div>
            <div id="user-info"></div>
            <button id="logout-btn" class="btn danger-btn" style="padding: 0.4rem 0.8rem; margin-top: 0.3rem;">چوونا دەرڤە</button>
        </div>
    </header>

    <main>
        <section id="login-view" class="view active">
            <div class="card">
                <h2>چوونا ژۆر (کرێکار)</h2>
                <form id="login-form">
                    <div class="form-group"><label for="worker-email">ئیمەیل:</label><input type="email" id="worker-email" required></div>
                    <div class="form-group"><label for="worker-password">پاسۆرد:</label><input type="password" id="worker-password" required></div>
                    <button type="submit" class="btn" style="width: 100%;">داخلبوون</button>
                </form>
            </div>
        </section>

        <section id="dashboard-view" class="view">
            <div class="dashboard-actions">
                <button id="start-scan-btn" class="action-button"><div class="icon">&#128247;</div><h3>فرۆتن ب سکان</h3></button>
                <button id="manual-entry-btn" class="action-button"><div class="icon">&#9997;</div><h3>تۆمارکرنا ب دەست</h3></button>
                <button id="price-check-btn" class="action-button"><div class="icon">&#128181;</div><h3>پشکنینا بهای</h3></button>
            </div>
            
            <div id="cart-container" class="card" style="display: none;">
                <h2>لیستا فرۆتنێ یا نها</h2>
                <ul id="cart-items-list"></ul>
                <div id="total-price-display">0 <small>دینار</small></div>
                <div style="display: flex; gap: 1rem;">
                    <button id="finalize-sale-btn" class="btn success-btn" style="flex-grow: 1;">پشتراستکرنا فرۆتنێ</button>
                    <button id="clear-cart-btn" class="btn danger-btn" style="flex-grow: 1;">ڤالاکرن</button>
                </div>
            </div>

            <div class="card">
                <h2>تۆمارێن فرۆتنێن من (ئەڤرۆ)</h2>
                <div class="list-wrapper">
                    <table id="sales-history-table">
                        <thead><tr><th>رووژ و دەم</th><th>کۆژمە</th><th>جور</th><th>پێکهاتە</th></tr></thead>
                        <tbody><tr><td colspan="4" style="text-align:center;">چ تۆمار نینن...</td></tr></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="price-check-view" class="view">
            <button class="btn back-btn" data-target="dashboard-view">&#8592; پاشڤەچوون</button>
            <div class="card">
                <h2>پشکنینا بهایێ بەرهەمان</h2>
                <div class="form-group"><input type="text" id="price-search-input" placeholder="لێگەریان ل گۆر ناڤ یان بارکۆد..."></div>
                <div class="list-wrapper">
                    <table id="price-check-results-table">
                        <thead><tr><th>ناڤێ بەرهەمی</th><th>بارکۆد</th><th>بهای</th></tr></thead>
                        <tbody><tr><td colspan="3" style="text-align:center;">ل بەرهەمەکێ بگەڕێ...</td></tr></tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>

    <div id="scanner-modal" class="modal"><div class="modal-content"><h3>کامیرێ بەرامبەر بارکۆدی بگرە</h3><div id="scanner-reader"></div><button type="button" id="stop-scan-btn" class="btn danger-btn" style="width:100%; margin-top:1rem;">داخستن</button></div></div>
    
    <div id="manual-entry-modal" class="modal"><div class="modal-content"><h3>تۆمارکرنا شولێ ب دەست</h3><form id="manual-entry-form"><div class="form-group"><label for="manual-amount">کۆژمێ پارەی (ب دینار):</label><input type="number" id="manual-amount" required placeholder="بۆ نمونە: 5000"></div><div class="form-group"><label for="manual-notes">تێبینی (ئختیاری):</label><input type="text" id="manual-notes" placeholder="بۆ نمونە: کریا گەهاندنێ"></div><div style="display: flex; gap: 1rem;"><button type="submit" class="btn success-btn" style="flex-grow: 1;">پێشکەفتن</button><button type="button" id="close-manual-modal-btn" class="btn" style="background-color: #6c757d; flex-grow: 1;">پاشڤەچوون</button></div></form></div></div>
    
    <div id="supervisor-code-modal" class="modal"><div class="modal-content"><h3>پشتراستکرن</h3><form id="supervisor-code-form"><div class="form-group"><label for="supervisor-code">کۆدێ سەرپەرشتیاری داخل بکە:</label><input type="password" id="supervisor-code" inputmode="numeric" pattern="[0-9]*" required></div><div style="display: flex; gap: 1rem;"><button type="submit" class="btn success-btn" style="flex-grow: 1;">پشتراستکرن</button><button type="button" id="close-code-modal-btn" class="btn" style="background-color: #6c757d; flex-grow: 1;">پاشڤەچوون</button></div></form></div></div>

    <div id="toast"></div>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>

    <script>
    const FIREBASE_CONFIG = {
        apiKey: "AIzaSyBslRXn1kjfJTm7sKtmoUtgyKkDA0Ro-34",
        authDomain: "ibrrahim-alkurdi.firebaseapp.com",
        projectId: "ibrrahim-alkurdi",
        storageBucket: "ibrrahim-alkurdi.appspot.com",
        messagingSenderId: "490128006332",
        appId: "1:490128006332:web:b7ff692d5ff4513a2644b9",
        measurementId: "G-Q4VWN89L3R"
    };

    firebase.initializeApp(FIREBASE_CONFIG);
    const auth = firebase.auth();
    const db = firebase.firestore();

    document.addEventListener('DOMContentLoaded', () => {
        const allViews = document.querySelectorAll('.view');
        const toast = document.getElementById('toast');
        const loader = document.getElementById('loader-overlay');
        const mainHeader = document.getElementById('main-header');
        const userInfo = document.getElementById('user-info');
        
        const loginForm = document.getElementById('login-form');
        const logoutBtn = document.getElementById('logout-btn');
        
        const startScanBtn = document.getElementById('start-scan-btn');
        const manualEntryBtn = document.getElementById('manual-entry-btn');
        const priceCheckBtn = document.getElementById('price-check-btn');
        document.querySelectorAll('.back-btn').forEach(btn => btn.addEventListener('click', () => switchView(btn.dataset.target)));

        const cartContainer = document.getElementById('cart-container');
        const cartItemsList = document.getElementById('cart-items-list');
        const totalPriceDisplay = document.getElementById('total-price-display');
        const finalizeSaleBtn = document.getElementById('finalize-sale-btn');
        const clearCartBtn = document.getElementById('clear-cart-btn');

        const scannerModal = document.getElementById('scanner-modal');
        const stopScanBtn = document.getElementById('stop-scan-btn');
        const manualEntryModal = document.getElementById('manual-entry-modal');
        const closeManualModalBtn = document.getElementById('close-manual-modal-btn');
        const manualEntryForm = document.getElementById('manual-entry-form');
        const supervisorCodeModal = document.getElementById('supervisor-code-modal');
        const supervisorCodeForm = document.getElementById('supervisor-code-form');
        const closeCodeModalBtn = document.getElementById('close-code-modal-btn');
        
        const salesHistoryTableBody = document.querySelector('#sales-history-table tbody');

        const priceSearchInput = document.getElementById('price-search-input');
        const priceCheckResultsTableBody = document.querySelector('#price-check-results-table tbody');

        let html5QrCode = null;
        let currentUser = null;
        let cart = [];
        let products = [];
        let tempManualAmount = 0;
        let tempManualNotes = '';

        const showToast = (message, type = 'success') => { toast.textContent = message; toast.className = type; toast.classList.add('show'); setTimeout(() => toast.classList.remove('show'), 4000); };
        const switchView = (viewId) => { allViews.forEach(v => v.classList.remove('active')); document.getElementById(viewId)?.classList.add('active'); window.scrollTo(0,0); };
        const showLoader = () => loader.style.display = 'flex';
        const hideLoader = () => loader.style.display = 'none';
        const formatCurrency = (number) => `${parseInt(number).toLocaleString()} <small>دینار</small>`;

        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                userInfo.textContent = `بخێرهاتی, ${user.email.split('@')[0]}`;
                mainHeader.style.display = 'flex';
                switchView('dashboard-view');
                loadInitialData();
            } else {
                currentUser = null;
                products = [];
                cart = [];
                mainHeader.style.display = 'none';
                switchView('login-view');
                hideLoader();
            }
        });
        
        async function loadInitialData() {
            showLoader();
            await Promise.all([fetchSalesHistory(), fetchAllProducts()]);
            hideLoader();
        }

        loginForm.addEventListener('submit', async e => { e.preventDefault(); showLoader(); const email = document.getElementById('worker-email').value; const password = document.getElementById('worker-password').value; try { await auth.signInWithEmailAndPassword(email, password); } catch (error) { showToast(`خەلەتی د داخلبوونێ دا: ${error.message}`, 'danger'); hideLoader(); } });
        logoutBtn.addEventListener('click', async () => { await auth.signOut(); cart = []; updateCartUI(); salesHistoryTableBody.innerHTML = '<tr><td colspan="4" style="text-align:center;">...</td></tr>'; showToast('ب سەرکەفتی چوویە دەرڤە.'); });
        
        function updateCartUI() { if (cart.length === 0) { cartContainer.style.display = 'none'; return; } cartContainer.style.display = 'block'; cartItemsList.innerHTML = cart.map(item => `<li><span class="item-name">${item.name}</span><span class="item-price">${formatCurrency(item.price)}</span></li>`).join(''); const total = cart.reduce((sum, item) => sum + item.price, 0); totalPriceDisplay.innerHTML = formatCurrency(total); }
        clearCartBtn.addEventListener('click', () => { if (confirm('تو پشتراستی دخوازی لیستێ ڤالا بکەی؟')) { cart = []; updateCartUI(); showToast('لیست هاتە ڤالاکرن.'); } });

        const onScanSuccess = async (decodedText) => { stopScanner(); showLoader(); try { const product = products.find(p => p.barcode === decodedText); if (!product) { showToast('ئەڤ بەرهەمە د سیستەمی دا نینە!', 'danger'); return; } if (product.quantity <= 0) { showToast('کەمیا ڤی بەرهەمی د کۆگەهێ دا نەمایە!', 'danger'); return; } cart.push({ productId: product.id, name: product.name, price: product.sellingPrice, barcode: product.barcode }); updateCartUI(); showToast(`"${product.name}" بۆ لیستێ هاتە زێدەکرن`); } catch (error) { console.error("Error finding product:", error); showToast('خەلەتیەک د پرۆسێسا دیتنا بەرهەمی دا روویدا', 'danger'); } finally { hideLoader(); } };
        const startScanner = () => { scannerModal.classList.add('active'); if (!html5QrCode) html5QrCode = new Html5Qrcode("scanner-reader"); html5QrCode.start({ facingMode: "environment" }, { fps: 10, qrbox: { width: 250, height: 250 } }, onScanSuccess).catch(err => { showToast('خەلەتی د ڤەکرنا کامیرێ دا.', 'danger'); scannerModal.classList.remove('active'); }); };
        const stopScanner = () => { if (html5QrCode && html5QrCode.isScanning) { html5QrCode.stop().catch(err => {}); } scannerModal.classList.remove('active'); };
        startScanBtn.addEventListener('click', startScanner);
        stopScanBtn.addEventListener('click', stopScanner);

        finalizeSaleBtn.addEventListener('click', async () => { if (cart.length === 0) { showToast('لیست ڤالایە، چ تشت نینە بۆ فرۆتنێ.', 'danger'); return; } showLoader(); const totalAmount = cart.reduce((sum, item) => sum + item.price, 0); const productQuantities = cart.reduce((acc, item) => { acc[item.productId] = (acc[item.productId] || 0) + 1; return acc; }, {}); try { const batch = db.batch(); const salesRef = db.collection('sales').doc(); batch.set(salesRef, { workerId: currentUser.uid, workerEmail: currentUser.email, timestamp: firebase.firestore.FieldValue.serverTimestamp(), totalAmount, type: 'scanned', items: cart }); for (const productId in productQuantities) { batch.update(db.collection('products').doc(productId), { quantity: firebase.firestore.FieldValue.increment(-productQuantities[productId]) }); } await batch.commit(); showToast('فرۆتن ب سەرکەفتی هاتە تۆمارکرن.'); cart = []; updateCartUI(); fetchSalesHistory(); } catch (error) { console.error("Error finalizing sale:", error); showToast('خەلەتی د تۆمارکرنا فرۆتنێ دا روویدا!', 'danger'); } finally { hideLoader(); } });

        manualEntryBtn.addEventListener('click', () => manualEntryModal.classList.add('active'));
        closeManualModalBtn.addEventListener('click', () => manualEntryModal.classList.remove('active'));
        manualEntryForm.addEventListener('submit', e => { e.preventDefault(); const amount = parseInt(document.getElementById('manual-amount').value); if (isNaN(amount) || amount <= 0) { showToast('تکایە کۆژمەکێ دروست داخل بکە', 'danger'); return; } tempManualAmount = amount; tempManualNotes = document.getElementById('manual-notes').value; manualEntryModal.classList.remove('active'); supervisorCodeModal.classList.add('active'); document.getElementById('supervisor-code').focus(); });
        
        closeCodeModalBtn.addEventListener('click', () => supervisorCodeModal.classList.remove('active'));
        supervisorCodeForm.addEventListener('submit', async e => { e.preventDefault(); const code = document.getElementById('supervisor-code').value; if (code !== "1234") { showToast('کۆدێ خەلەتە! پرۆسە هاتە راوەستاندن.', 'danger'); supervisorCodeForm.reset(); return; } supervisorCodeModal.classList.remove('active'); supervisorCodeForm.reset(); showLoader(); try { await db.collection('sales').add({ workerId: currentUser.uid, workerEmail: currentUser.email, timestamp: firebase.firestore.FieldValue.serverTimestamp(), totalAmount: tempManualAmount, type: 'manual', items: [{ name: tempManualNotes || "تۆمارا دەستی", price: tempManualAmount }] }); showToast('کار ب سەرکەفتی هاتە تۆمارکرن.'); manualEntryForm.reset(); fetchSalesHistory(); } catch (error) { console.error("Error saving manual entry:", error); showToast('خەلەتی د تۆمارکرنا کاری دا روویدا!', 'danger'); } finally { hideLoader(); } });

        async function fetchSalesHistory() {
            if (!currentUser) return;
            try {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const snapshot = await db.collection('sales').where('workerId', '==', currentUser.uid).where('timestamp', '>=', today).orderBy('timestamp', 'desc').get();
                if (snapshot.empty) { salesHistoryTableBody.innerHTML = '<tr><td colspan="4" style="text-align:center;">چ فرۆتن بۆ ئەڤرۆ نەهاتینە تۆمارکرن.</td></tr>'; return; }
                salesHistoryTableBody.innerHTML = snapshot.docs.map(doc => {
                    const sale = doc.data();
                    const saleTime = sale.timestamp ? sale.timestamp.toDate().toLocaleString('ar-IQ', { dateStyle: 'short', timeStyle: 'short' }) : 'N/A';
                    const itemsSummary = sale.items.map(i => i.name).join(', ');
                    return `<tr><td>${saleTime}</td><td class="amount-col">${formatCurrency(sale.totalAmount)}</td><td>${sale.type === 'scanned' ? 'سکان' : 'دەستی'}</td><td>${itemsSummary.substring(0, 50)}</td></tr>`;
                }).join('');
            } catch (error) {
                console.error("Error fetching sales history:", error);
                showToast('خەلەتی د ئینانا تۆمارێن فرۆتنێ دا! پشتراستبە تە ئیندێکس دروستکریە.', 'danger');
                salesHistoryTableBody.innerHTML = `<tr><td colspan="4" style="text-align:center; color: var(--danger-color);">خەلەتی! تکایە پشتراستبە کو تە ئیندێکس ب دروستی دروستکریە.</td></tr>`;
            }
        }
        
        priceCheckBtn.addEventListener('click', () => switchView('price-check-view'));
        async function fetchAllProducts() {
            try {
                const snapshot = await db.collection('products').get();
                products = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            } catch (error) {
                console.error("Error fetching products:", error);
                showToast('خەلەتی د ئینانا لیستا بەرهەمان دا', 'danger');
            }
        }

        priceSearchInput.addEventListener('input', e => {
            const searchTerm = e.target.value.toLowerCase();
            if (searchTerm.length < 2) {
                priceCheckResultsTableBody.innerHTML = '<tr><td colspan="3" style="text-align:center;">ل ناڤ یان بارکۆد بگەڕێ...</td></tr>';
                return;
            }
            const filteredProducts = products.filter(p => p.name.toLowerCase().includes(searchTerm) || (p.barcode && p.barcode.includes(searchTerm)));
            if (filteredProducts.length === 0) {
                priceCheckResultsTableBody.innerHTML = '<tr><td colspan="3" style="text-align:center;">چ بەرهەم نەهاتنە دیتن.</td></tr>';
                return;
            }
            priceCheckResultsTableBody.innerHTML = filteredProducts.map(p => `
                <tr>
                    <td>${p.name}</td>
                    <td>${p.barcode || 'N/A'}</td>
                    <td class="price-col">${formatCurrency(p.sellingPrice)}</td>
                </tr>
            `).join('');
        });
    });
    </script>
</body>
</html>
